{% extends 'blog/base.html' %}
{% load staticfiles %}

{% block content %}
    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url('{% static "img/post-bg.jpg" %}')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>{{post.title}}</h1> <a class="mui-btn" href="{% url 'post_edit' pk=post.pk %}">Edit Post</a>
                        <h2 class="subheading">{{post.subtitle}}</h2>
                        <span class="meta">Posted by <a href="#">{{user}}</a>{% if post.published_date %} published: {{ post.published_date }}  {% endif %}</span>
                      </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Post Content -->
    <article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    {{post.text}}
                </div>
            </div>
        </div>
    </article>

    <hr>

    {% if user.is_authenticated %}
      <a class="btn btn-default" href="{% url 'add_comment_to_post' pk=post.pk %}">Add comment</a>
    {% else %}
      <a class="btn btn-default" href="http://localhost:8000/">Sign in at our home page to comment</a>
    {% endif %}

  {% for comment in post.comments.all %}
    {% if user.is_authenticated or comment.approved_comment %}
    <div class="comment">
        <div class="date">
            {{ comment.created_date }}
            {% if not comment.approved_comment %}
                <a class="btn btn-default" href="{% url 'comment_remove' pk=comment.pk %}"><span class="glyphicon glyphicon-remove"></span></a>
                <a class="btn btn-default" href="{% url 'comment_approve' pk=comment.pk %}"><span class="glyphicon glyphicon-ok"></span></a>
            {% endif %}
        </div>
        <strong>{{ comment.author }}</strong>
        <p>{{ comment.text|linebreaks }}</p>
    </div>
    {% endif %}
    {% empty %}
      <p class = "comment">No comments here yet :(</p>
  {% endfor %}
{% endblock %}
